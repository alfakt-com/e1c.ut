
&НаКлиенте
Процедура ПапкаДляLogФайловНачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
	
	Диалог = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.ВыборКаталога);
	Диалог.МножественныйВыбор = Ложь;	
	
	Если Диалог.Выбрать() Тогда 
		ПапкаДляLogФайлов = Диалог.Каталог;
		Если Прав(ПапкаДляLogФайлов,1) <> "\" Тогда 
			ПапкаДляLogФайлов = ПапкаДляLogФайлов + "\";
		КонецЕсли;
		
		Объект.ПапкаДляLogФайлов = ПапкаДляLogФайлов;
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура Подбор(Команда)
	ПараметрыФормы = Новый Структура();
	ПараметрыФормы.Вставить("Объект",Объект);
	ПараметрыФормы.Вставить("МножественныйВыбор",Истина);
	Форма = ПолучитьФорму("Справочник.Номенклатура.ФормаВыбора",ПараметрыФормы,ЭтаФорма);
	Форма.Заголовок = "Подбор Kaspi";
	//Форма.МножественныйВыбор = Истина;
	Форма.Открыть();
КонецПроцедуры

&НаКлиенте
Процедура ОбработкаВыбора(ВыбранноеЗначение, ИсточникВыбора)
	Если ТипЗнч(ВыбранноеЗначение) = Тип("Массив") Тогда
		Для Каждого Стр из ВыбранноеЗначение Цикл
			СтрокаУзла = Объект.СписокНоменклатуры.Добавить();
			СтрокаУзла.Номенклатура = Стр;
		КонецЦикла;
	Иначе
		СтрокаУзла = Объект.СписокНоменклатуры.Добавить();
		СтрокаУзла.Номенклатура = ВыбранноеЗначение;
	КонецЕсли;
КонецПроцедуры

&НаКлиенте
Процедура Выгрузить(Команда)
	Kaspi_ОбменКлиент.ПровестиВыгрузкуПоУзлам();
КонецПроцедуры

&НаСервере
Процедура ЗаполнитьПорогНаСервере(Порог)
	Для Каждого стр из Объект.СписокНоменклатуры Цикл
		Стр.порог = Порог;
	КонецЦикла;
КонецПроцедуры

&НаКлиенте
Процедура ЗаполнитьПорог(Команда)
	ЗаполнитьПорогНаСервере(Порог);
КонецПроцедуры
